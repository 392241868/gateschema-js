!function(t,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports):"function"==typeof define&&define.amd?define(["exports"],a):a(t.GateSchema={})}(this,function(t){"use strict";var a=[{name:"r",add:function(){return this.required}},{name:"o",add:function(){return this.optional}},{name:"bool",add:function(){return this.boolean}},{name:"num",add:function(){return this.number}},{name:"str",add:function(){return this.string}},{name:"bin",add:function(){return this.binary}},{name:"cond",add:function(){var r=this;return function(t,a,n){var e=r.constructor;return r.switch(t,[{case:e.required,schema:a},{case:e.any,schema:n||e.any}])}}}];function m(t){return null!=t&&"object"==typeof t}function A(t){return Array.isArray(t)?t:t.constraints}var n,g=(n=Array.from)?function(t){return t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length}:function(t){return n(t).length};var r=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function u(t,n){var e,r=this,i=t.path,a=t.args,o=t.rootData,s=t.state,u=void 0===s?{}:s,d=t.options,c=a[0],f=c.length,h=this.getValue(i,o,i,u.values),l=function(a){a<f?(e=c[a],r.validate(h,{schema:e,path:i,rootData:o,state:u,options:d},function(t){t?l(++a):n(e)})):n()};l(0)}function d(t,r){var i=this,a=t.path,n=t.args,o=t.rootData,e=t.state,s=void 0===e?{}:e,u=t.options,d=n[0],c=n[1],f=c.length,h=this.getValue(d,o,a,s.values),l=function(a){if(a<f){var t=c[a],n=t.case,e=t.schema;i.validate(h,{schema:n,path:d,rootData:o,state:s,options:u},function(t){t?l(++a):r(e)})}else r()};l(0)}var o=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,s=[0,31,28,31,30,31,30,31,31,30,31,30,31],c=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,e=/t|\s/i,i=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,f=/\/|:/,h=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,l=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,p=/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,F=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,v=/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i;function y(t){var a=t.match(o);if(!a)return!1;var n,e=+a[1],r=+a[2],i=+a[3];return 1<=r&&r<=12&&1<=i&&i<=(2!==r||((n=e)%4!=0||n%100==0&&n%400!=0)?s[r]:29)}var D={date:y,"date-time":function(t){var a=t.split(e);return 2===a.length&&y(a[0])&&function(t,a){var n=t.match(c);if(!n)return!1;var e=+n[1],r=+n[2],i=+n[3],o=n[5];return(e<=23&&r<=59&&i<=59||23===e&&59===r&&60===i)&&(!a||o)}(a[1],!0)},email:function(t){return p.test(t)},hostname:function(t){return t.length<=255&&i.test(t)},ipv4:function(t){return F.test(t)},ipv6:function(t){return v.test(t)},uri:function(t){return f.test(t)&&h.test(t)},url:function(t){return l.test(t)}},b=[{name:"required",add:function(){var t=this.constraints[0];return!t||"optional"!==t&&"optional"!==t.name?this.constraints.unshift("required"):this.constraints.splice(0,1,"required"),this.lastConstraintIndex=0,this},validator:function(t,a,n){null==t?n(!0):n()}},{name:"optional",add:function(){var t=this.constraints[0];return!t||"required"!==t&&"required"!==t.name?this.constraints.unshift("optional"):this.constraints.splice(0,1,"optional"),this.lastConstraintIndex=0,this},validator:function(t,a,n){null==t?n(this.BREAK):n()}},{name:"boolean",validator:function(t,a,n){var e=a.path;n((a.state.types[e]="boolean")!=typeof t)}},{name:"number",validator:function(t,a,n){var e=a.path;if((a.state.types[e]="number")==typeof t||r.test(t))return n();n(!0)}},{name:"string",validator:function(t,a,n){var e=a.path;n((a.state.types[e]="string")!=typeof t)}},{name:"binary",validator:function(t,a,n){var e,r=a.path;return a.state.types[r]="binary","string"==typeof(e=t)&&/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(e)?n():"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?n():void n(!0)}},{isHighOrder:!0,name:"map",validator:function(a,t,n){var e=this,r=t.path,i=t.rootData,o=t.state,s=t.args,u=t.options;o.types[r]="map";var d=s[0],c=Object.keys(d),f=c.length,h=o.values,l=o.mapDefinitions;if(l[r]?l[r].push(d):(h[r]=a,l[r]=[d]),!m(a))return n(!0);var p,g,F=0,v=function(t){return t?n(t):F<f?(p=c[F++],g=d[p],e.validate(a[p],{schema:g,path:"/"===r?"/"+p:r+"/"+p,rootData:i,state:o,options:u},v)):n(t)};v()},getChildSchema:function(t,a){var n=t.childKey;a(t.args[0][n])}},{isHighOrder:!0,name:"list",validator:function(n,t,e){var r=this,i=t.path,o=t.rootData,s=t.state,a=t.args,u=t.options;if(!Array.isArray(n))return e(!0);s.types[i]="list";var d=0,c=n.length,f=a[0],h=function(t){if(t)return e(t);if(d<c){var a=d++;return r.validate(n[a],{schema:f,path:"/"===i?"/"+a:i+"/"+a,rootData:o,state:s,options:u},h)}return e(t)};h()}},{getMatchSchema:u,isHighOrder:!0,name:"oneOf",validator:function(t,a,n){var e=a.path,r=a.rootData,i=a.state,o=a.args,s=a.options;u.call(this,{path:e,args:o,rootData:r,state:i,options:s},function(t){t?n():n(!0)})}},{name:"any",validator:function(t,a,n){n()}},{isHighOrder:!0,name:"enum",validator:function(t,a,n){var e=a.args[0],r=void 0===e?{}:e;for(var i in r)if(r[i]===t)return n();var o=Object.keys(r),s=o.map(function(t){return r[t]});n({keys:JSON.stringify(o),values:JSON.stringify(s)})}},{isHighOrder:!0,name:"enumList",validator:function(t,a,e){var n=a.path,r=a.rootData,i=a.args,o=a.state,s=a.options,u=i[0],d=void 0===u?{}:u,c=[{keyword:"list",args:[[{keyword:"enum",args:[d]}]]}];this.validate(t,{schema:c,path:n,rootData:r,state:o,options:s},function(t){if(t){var a=Object.keys(d),n=a.map(function(t){return d[t]});return e({keys:a,values:n})}e()})}},{isHighOrder:!0,name:"value",validator:function(t,a,n){var e=a.args[0];return t!==e?n({value:e}):n()}},{isHighOrder:!0,name:"format",validator:function(t,a,n){var e=a.args[0],r=D[e];return r?r(t)?n():n({format:e}):n(new Error("no validator for format: "+e))}},{isHighOrder:!0,name:"pattern",add:function(){var e=this;return function(t,a){var n={keyword:"pattern"};if(t instanceof RegExp)n.args=[t.source,t.flags];else{if("string"!=typeof t)throw new Error("pattern should be an RegExp instance or RegExp source string");n.args=[t,a]}return e.add(n),e}},validator:function(t,a,n){var e,r=a.args;try{e=RegExp.apply(null,r)}catch(t){return n(new Error("invalid pattern"))}return n(!e.test(t))}},{isHighOrder:!0,name:"length",validator:function(t,a,n){var e,r,i,o,s,u,d=a.path,c=a.state,f=a.args,h=c.types[d];if(!h)return n(new Error("missing type declaration"));switch(h){case"string":e=g(t);break;case"list":e=t.length;break;case"binary":if("string"==typeof t){if(0<(e=t.length)){var l=t.indexOf("=");e=3*e/4-(-1<l?e-l:0)}}else e=t.byteLength;break;default:return n(new Error("can't use length constraint on type: "+h))}var p=f[0];if(Array.isArray(p))if(s=p[0],u=p[1],null!=s&&null!=u)(e<s||u<e)&&(r=!0,i="range");else if(null!=s)e<s&&(r=!0,i="min");else{if(null==u)return n(new Error("missing minLength or maxLength"));u<e&&(r=!0,i="max")}else e!==(o=p)&&(r=!0,i="match");if(r)return n({KEY:"length_"+h+"_"+i,length:o,maxLength:u,minLength:s,valueLength:e});n()}},{name:"unique",validator:function(t,a,n){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];if(-1!==e.indexOf(o))return n(!0);e.push(o)}n()}},{isHighOrder:!0,name:"not",validator:function(t,a,n){var e=a.path,r=a.rootData,i=a.state,o=a.args,s=a.options,u=o[0];this.validate(t,{schema:u,path:e,rootData:r,state:i,options:s},function(t){t?n():n(!0)})}},{name:"notEmpty",validator:function(t,a,n){var e=typeof t;switch(!0){case"number"===e:n(0===t);break;case"string"===e:n(""===t);break;case Array.isArray(t):n(0===t.length);break;case m(t):n(0===Object.keys(t).length);break;default:n(null==t)}}},{isHighOrder:!0,name:"equal",validator:function(t,a,n){var e=a.path,r=a.rootData,i=a.state,o=a.args[0];return t!==this.getValue(o,r,e,i.values)?n({id:o}):n()}},{getMatchSchema:d,isHighOrder:!0,name:"switch",validator:function(a,t,n){var e=this,r=t.path,i=t.rootData,o=t.state,s=t.args,u=t.options;d.call(this,{args:s,path:r,rootData:i,state:o,options:u},function(t){t?e.validate(a,{schema:A(t),path:r,rootData:i,state:o,options:u},n):n()})}},{name:"allowAdditional",validator:function(t,a,n){var e=a.path;a.state.mapAllowAdditional[e]=!0,n()}},{isHighOrder:!0,name:"other",validator:function(t,a,n){n()}}];var _,O={$clone:function(t){void 0===t&&(t={});var a=t.pick,n=t.omit,e=JSON.parse(JSON.stringify(this)),r=a?o(function(t){return-1===a.indexOf(t)}):n?o(function(t){return-1<n.indexOf(t)}):function(){},i=function(t){t.forEach(function(t){"map"===t.keyword&&r(t.args[0]),"switch"===t.keyword&&t.args[1].forEach(function(t){i(t.schema)})})};function o(n){return function(t){for(var a in t)n(a)&&delete t[a]}}return i(e),new this.constructor({constraints:e})},$keys:function(){var a=[];return this.constraints.forEach(function(t){"map"===t.keyword?a=a.concat(Object.keys(t.args[0])):"switch"===t.keyword&&t.args[1].forEach(function(t){a=a.concat(t.schema.$keys())})}),a},$msg:function(t){var a=this.lastConstraintIndex,n=this.constraints,e=n[a];return e&&("string"==typeof e&&(e={keyword:e},n.splice(a,1,e)),e.msg=t),this},$get:function(t,a,n,e){return"function"==typeof a?(e=a,a=void 0):"function"==typeof n&&(e=n,n={}),this.constructor.getSchema(t,{rootData:a,options:n,rootSchema:this},e),this}},x=function(t){Object.assign(this,t)},w=(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var n in a)a.hasOwnProperty(n)&&(t[n]=a[n])},function(t,a){function n(){this.constructor=t}_(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)});function $(t,a,n,e){var r=e.cache,i=[n,t];r[a]?r[a].push(i):r[a]=[i]}var E=function(){function u(t){void 0===t&&(t={});var a=t.constraints;void 0===a&&(a=this.initConstraints.slice()),this.constraints=a,Object.defineProperty(this,"lastConstraintIndex",{value:0,writable:!0})}return u.addAlias=function(t){var a=t.name,n=t.add,e=this,r=e.prototype;if(r[a])throw new Error("keyword "+a+" conflict");Object.defineProperty(e,a,{get:function(){return(new e)[a]}}),Object.defineProperty(r,a,{get:function(){return n.call(this)}})},u.addKeyword=function(t,a){var n=t.name,e=t.validator,r=t.getChildSchema,i=t.getMatchSchema,o=t.isAsync,s=this.prototype;Object.defineProperty(this,n,{get:function(){return(new this)[n]}}),Object.defineProperty(s,n,{get:this.createAddFunction(t)}),a&&this.addMsgs(a),o&&(this._asyncKeywords[n]=!0),this._validators[n]=e,r&&(this._getChildSchema[n]=r),i&&(this._getMatchSchema[n]=i)},u.createAddFunction=function(t){var e=t.name,a=t.isHighOrder,n=t.add;return"function"==typeof n?n:a?function(){var n=this;return function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];if(!t)throw new Error("arguments are required");return n.add({args:t,keyword:e})}}:function(){return this.add(e)}},u.addMsgs=function(t){Object.assign(this.msgs,t)},u.resolvePath=function(t,a){if(0===t.indexOf("./"))t=a.slice(0,a.lastIndexOf("/"))+t.slice(1);else if(0===t.indexOf("../")){var n=t.split("../"),e=n.length;if(!(e<=a.split("/").length))throw new Error("Can't resolve "+a);t=a.split("/").slice(0,-e).concat(n[e-1]).join("/")}return t},u.getValue=function(t,a,n,e){if(void 0===e&&(e={}),"/"===t)return a;if(null!=n&&(t=this.resolvePath(t,n)),!Object.getOwnPropertyDescriptor(e,t)){var r=void 0,i=void 0,o=void 0,s=t.lastIndexOf("/");0<s?(r=t.slice(s+1),i=t.slice(0,s),o=u.getValue(i,a,null,e)):(r=t.slice(1),o=a),m(o)&&(e[t]=o[r])}return e[t]},u.getSchema=function(t,a,n){var p=this,g=a.options,e=a.rootSchema,F=a.rootData;if("/"===t)return n(e);var r,i=t.split("/").slice(1),v=function(t,a){var n,e,r,i,o,s=t.childKey,u=t.parentPath,d=t.schema,c=0,f=A(d),h=f.length,l=function(t){!t&&c<h?("object"==typeof(n=f[c++])?(e=n.keyword,r=n.args):(e=n,r=[]),i=p._getMatchSchema[e],o=p._getChildSchema[e],i?i.call(p,{path:u,args:r,rootData:F,state:m,options:g},function(t){t?v({childKey:s,parentPath:u,schema:t},l):l()}):o?o.call(p,{args:r,childKey:s},l):l()):a(t)};l()},o=0,s="",u=i.length,m={mapAllowAdditional:{},mapDefinitions:{},types:{},values:{},cache:{}},d=function(t){t?o<u?(s+=r?"/"+r:"/",r=i[o++],v({childKey:r,parentPath:s,schema:t},d)):n(Array.isArray(t)?new p({constraints:t}):t):n()};d(e)},u.extend=function(t){void 0===t&&(t={});var a=t.defaultOptions,n=t.initConstraints,e=t.keywords,r=t.aliases,i=t.msgs,o=this,s=function(t){function a(){return null!==t&&t.apply(this,arguments)||this}return w(a,t),a}(o);Object.assign(s,o),s.msgs=Object.create(o.msgs),s._validators=Object.create(o._validators),s._getChildSchema=Object.create(o._getChildSchema),s._getMatchSchema=Object.create(o._getMatchSchema);var u=s.prototype;return a&&(u.defaultOptions=a),n&&(u.initConstraints=n),Array.isArray(e)&&e.forEach(function(t){s.addKeyword(t)}),Array.isArray(r)&&r.forEach(function(t){s.addAlias(t)}),i&&s.addMsgs(i),s},u.getMsg=function(t){return this.msgs[t]},u.createError=function(t,a,n,e){var r=e.constraint,i={keyword:t,msgParams:n,path:e.path,value:a},o=r.msg||this.getMsg(n.KEY);return i.msg=this.formatMsg(o,n,r)||"invalid value",new this.Error(i)},u.formatMsg=function(t,n,a){return t&&-1<t.indexOf("${")&&(t=t.replace(/\$\{(.+?)\}/g,function(t,a){return n[a]})),t},u.validate=function(n,t,e){var r=this,i=t.path,o=t.rootData,s=t.schema,u=t.state,a=t.options,d=void 0===a?{}:a,c=function(t,a,n){var e=n.cache;if(void 0!==e[t]){var r=e[t].find(function(t){return t[0]===a});if(r)return r[1]}}(i,s,u);if(c)return e(c);var f,h,l,p,g,F=this._validators,v=this.BREAK,m=this.Error,y=this._asyncKeywords,D=d.removeAdditional,b=d.skips,_=d.skipAsync,O=A(s),x=O.length,w=0,E=function(t){if(t){switch(!0){case t===v:g=null;break;case t instanceof m:g=t;break;case t instanceof Error:throw t;default:var a=!0===t?{}:t;a.KEY||(a.KEY=p),g=r.createError(p,n,a,{constraint:f,path:i,rootData:o,state:u})}$(g,i,s,u),e(g)}else w<x?(f=O[w++],p="string"==typeof f?f:f.keyword,_&&y[p]&&E(),h=f.args,(l=F[p])?l.call(r,n,{args:h,path:i,rootData:o,state:u,options:d},E):b&&-1<b.indexOf(p)?E():e(new Error("no validator for keyword: "+p+", constraint: "+JSON.stringify(f)))):($(null,i,s,u),D&&function(t,a){var n=a.values,e=a.mapAllowAdditional,r=a.mapDefinitions[t];if(r&&!e[t]){var i=n[t],o=r.reduce(function(t,a){return t.push.apply(t,Object.keys(a)),t},[]);for(var s in i)-1===o.indexOf(s)&&delete i[s]}}(i,u),e(null))};E()},u.prototype.add=function(t){return this.lastConstraintIndex=this.constraints.length,this.constraints.push(t),this},u.prototype.validate=function(){for(var t=this,a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];var e=arguments[0],r=arguments[1],i=arguments[2];"function"==typeof r&&(i=r,r=void 0),null==r&&(r=this.defaultOptions);var o={schema:this.constraints,path:"/",rootData:e,state:{mapAllowAdditional:{},mapDefinitions:{},types:{},values:{},cache:{}},options:r};if("function"!=typeof i)return new Promise(function(a,n){t.constructor.validate(e,o,function(t){return t?n(t):a(t)})});this.constructor.validate(e,o,function(t){i(t)})},u.prototype.toJSON=function(){return JSON.parse(JSON.stringify(this.constraints))},u.BREAK=Symbol("break"),u.msgs={},u._asyncKeywords={},u._validators={},u._getMatchSchema={},u._getChildSchema={},u.Error=x,u}();E.prototype.defaultOptions={},E.prototype.initConstraints=[];var k=E.extend({aliases:a,keywords:b,msgs:{binary:"should be binary",boolean:"should be true or false",number:"should be a number",string:"should be a string",list:"should be an list",map:"should be a map",enum:"should be one of ${values}",enumList:"should be a list only containing these values: ${values}",not:"invalid value",equal:"should equal to the value of ${id}",format:"invalid ${format} format",length_string_match:"should contain ${length} characters",length_string_min:"should contain at least ${maxLength} characters",length_string_max:"should contain at most ${maxLength} characters",length_string_range:"should contain ${minLength} to ${maxLength} characters",length_list_match:"should contain ${length} items",length_list_min:"should contain at least ${minLength} items",length_list_max:"should contain at most ${maxLength} items",length_list_range:"should contain ${minLength} to ${maxLength} items",length_binary_match:"should contain ${length} bytes",length_binary_min:"should contain at least ${minLength} bytes",length_binary_max:"should contain at most ${maxLength} bytes",length_binary_range:"should contain ${minLength} to ${maxLength} bytes",notEmpty:"should not be empty",oneOf:"invalid value",pattern:"invalid format",required:"should not be null or undefined",requiredOne:"at least one field of ${keys} could not be undefined or null",switch:"no matching case",unique:"each element should be unique",value:"should be ${value}"}}),C=k.extend({initConstraints:["required"]}),z=k.extend({initConstraints:["optional"]});Object.assign(E.prototype,O),t._=k,t.r=C,t.o=z,t.default=k,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=gateschema.min.js.map
